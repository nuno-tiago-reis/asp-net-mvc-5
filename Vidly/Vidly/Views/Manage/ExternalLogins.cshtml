@using Microsoft.Owin.Security

@model Vidly.Models.ExternalLoginsViewModel

@{
	ViewBag.Title = "External logins";
}

<p class="text-success">@ViewBag.StatusMessage</p>
@{
	var loginProviders = Context.GetOwinContext().Authentication.GetExternalAuthenticationTypes();
	if (!loginProviders.Any())
	{
		<div>
			<p>
				There are no external authentication services configured. See <a href="https://go.microsoft.com/fwlink/?LinkId=313242">this article</a>
				for details on setting up this ASP.NET application to support logging in via external services.
			</p>
		</div>
	}
	else
	{
		if (Model.RegisteredLogins.Count > 0)
		{
			<h3>Registered Logins</h3>
			<br />

			<table class="table">
				<tbody>
					@foreach (var account in Model.RegisteredLogins)
					{
						<tr>
							<td>@account.LoginProvider</td>
							<td>
								@if (ViewBag.ShowRemoveButton)
								{
									using (Html.BeginForm("RemoveLogin", "Manage"))
									{
										@Html.AntiForgeryToken()
										<div>
											@Html.Hidden("loginProvider", account.LoginProvider)
											@Html.Hidden("providerKey", account.ProviderKey)
											<input type="submit" class="btn btn-default" value="Remove" title="Remove this @account.LoginProvider login from your account" />
										</div>
									}
								}
								else
								{
									@: &nbsp;
								}
							</td>
						</tr>
					}
				</tbody>
			</table>
		}

		if (Model.UnregisteredLogins.Count > 0)
		{
			<h3>Unregistered Logins</h3>
			<br />

			using (Html.BeginForm("AddLogin", "Manage"))
			{
				@Html.AntiForgeryToken()
				<div id="socialLoginList">
					<p>
						@foreach (var login in Model.UnregisteredLogins)
						{
							<button type="submit" class="btn btn-default" id="@login.AuthenticationType" name="provider" value="@login.AuthenticationType" title="Log in using your @login.Caption account">@login.AuthenticationType</button>
						}
					</p>
				</div>
			}
		}
	}
}